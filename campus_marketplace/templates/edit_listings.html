{% extends 'base.html' %}

{% block content %}
<div style="max-width: 600px; margin: 2rem auto; padding: 2rem; background: white; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
  <h2 style="text-align: center; color: #DA291C;">‚úèÔ∏è Edit Listing</h2>
  
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <label style="display: block; margin-top: 1rem; font-weight: bold;">Title</label>
    <input type="text" name="title" value="{{ listing.title }}" required 
           style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">

    <label style="display: block; margin-top: 1rem; font-weight: bold;">Description</label>
    <textarea name="description" rows="4" 
              style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">{{ listing.description }}</textarea>

    <label style="display: block; margin-top: 1rem; font-weight: bold;">Price ($)</label>
    <input type="number" step="0.01" name="price" value="{{ listing.price|default_if_none:'' }}" placeholder="Leave blank for 'Contact me'"
           style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">

    <label style="display: block; margin-top: 1rem; font-weight: bold;">Category</label>
    <select name="category" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
      {% for value, label in category_choices %}
        <option value="{{ value }}" {% if listing.category == value %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>

    <label style="display: block; margin-top: 1rem; font-weight: bold;">Residence</label>
    <select name="residence" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;">
      {% for value, label in residence_choices %}
        <option value="{{ value }}" {% if listing.residence == value %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>

    <label style="display: block; margin-top: 1rem; font-weight: bold;">Current Image</label>
    {% if listing.image %}
        <img src="{{ listing.image.url }}" style="height: 100px; border-radius: 8px; margin-bottom: 10px;">
    {% endif %}
    <br>
    <label>Change Image (Optional):</label>
    <input type="file" name="image" accept="image/*">

    <div style="margin-top: 2rem; display: flex; gap: 1rem;">
        <button type="submit" class="btn">üíæ Save Changes</button>
        <a href="{% url 'listing_detail' listing.pk %}" class="btn" style="background: #6c757d;">Cancel</a>
    </div>
  </form>
</div>
{% endblock %}